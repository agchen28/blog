---
date: 2016-07-09T12:55:43+08:00
draft: false
tags: ["redis"]
categories: ["技术相关"]
title: Redis中的数据类型
---

Redis中的数据类型包括：String、Hash、List、Set、SortedSet。

### String

可以用来存放字符串或者数值类型，对于数值类型可以进行增加或减少操作。

#### 实现一个简单的分布式锁  

客户端执行命令：
```
SET resource-name anystring NX EX max-lock-time
```
如果服务端返回OK，那么获得锁。如果返回nil，请稍后再试。

#### 计数器和限速器
使用 INCR 命令来统计用户一个时间段的操作次数，限速器可以用来限制一个公开API在一个时间段内的请求次数。

#### Bitmap
Bitmap 对于一些特定类型的计算非常有效。  
比如需要记录用户每天是否上线，计算总共上线天数，就可以使用 SETBIT 和 BITCOUNT 来实现。  
假设我们需要为每个用户记录一个特殊属性，例如是否活跃用户，是否黑名单用户。我们可以将属性值作为key，用户id作为偏移量，通过 SETBIT 和 GETBIT 命令来实现。

### Hash
也可以用来存储字符串和数值类型，数值类型可以增减操作。  
适合用来存储对象，每个key下面的field对应该对象的一个属性，对该对象任一个属性读写操作的时间复杂度都是O(1)。  
使用 HMGET 和 HMSET 命令可以读写多个field，时间复杂度为O(N)，N是给定的field数量。  
使用 HGETALL 命令会返回该hash的所有field和value，时间复杂度是O(N)，N为该hash的大小。

### List
List是有序的列表，支持双端操作，还有阻塞的操作，可以用来实现阻塞队列。  

#### 事件提醒
我们经常会使用轮询的方式来查询List中是否有新元素达到。
另一种更好的方式是，使用 BLPOP 或者 BRPOP ，在新元素到达时立即进行处理，而新元素还没到达时，就一直阻塞住，避免轮询占用资源。

#### 安全队列
使用 RPOPLPUSH 命令(或者它的阻塞版本 BRPOPLPUSH )实现安全队列。该命令返回一个消息，并把该消息塞入一个备份列表中，当消息处理成功后再用 LREM 命令将这个消息从备份表删除。

#### 循环列表
给 RPOPLPUSH 命令的两个参数传入相同的key，可以不停地循环取出该列表中的元素。  
循环列表可以应用在服务器的监控程序，不停地监控一组服务是否正常工作。

### Set
set为无序，且不重复的集合，且提供O(1)复杂度度的快速查找。set集合支持集合的并，交，差操作。

### SortedSet
可排序的集合，根据score进行排序，如果两个score相同，则按照value的字典序排序。




